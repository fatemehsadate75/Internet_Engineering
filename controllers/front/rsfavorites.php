<?php
 class ranginesmsprestarsfavoritesModuleFrontController extends ModuleFrontController { public $auth = false; public $guestAllowed = true; public $display_column_left = false; public $display_column_right = false; public function init(){ parent::init(); } public function initContent(){ parent::initContent(); $cookie = new Cookie('oos_mobile_report'); if($cookie->variable_name){ $ranginesmspresta = new RangineSmsPresta; $ooss = $ranginesmspresta->getOOS(0, 'all', null,$cookie->variable_name); if(count($ooss)){ $output = "<table class='table table-bordered table-striped table-responsive'><tr><th>نام محصول</th><th>ترکیب خاص</th><th>عملیات</th></tr>"; foreach ($ooss as $oos) { $product = new Product((int) $oos['id_product'],false,$oos['id_lang']); $product_name = $product->name; $attributes = $product->getAttributesGroups((int)$oos['id_lang']); $attribute_nameArray = array(); $product_url = $ranginesmspresta->productShortLink($oos['id_product']); foreach ($attributes as $attribute) { if(isset($attribute['id_product_attribute']) && $attribute['id_product_attribute'] == $oos['id_product_attribute']){ $attribute_nameArray[] = $attribute['group_name'] . ': ' . $attribute['attribute_name']; $attribute_nameArray[] = StockAvailable::getStockAvailableIdByProductId($oos['id_product'], $attribute['id_product_attribute']); $product_quantity = StockAvailable::getQuantityAvailableByProduct($oos['id_product'], $attribute['id_product_attribute']); } } $attribute_name = implode(' - ', $attribute_nameArray); $action = '<button class="deleteoos" data-product="'.$oos['id_product'].'" data-attribute="'.$oos['id_product_attribute'].'" data-shop="'.$oos['id_shop'].'" data-phonenumber="'.$oos['phone_number'].'">حذف</button>'; $output .= "<tr>
						<td><a href='{$product_url}' target='_blank'>{$oos['id_product']} - {$product_name}</a></td>
						<td>{$attribute_name}</td>
						<td>{$action}</td>
						</tr>
					"; } $output .= "</table>"; }else{ $output = "<p>شما در اطلاع رسانی هیچ یک از محصولات سایت ما ثبت نام نکرده اید.</p>"; } $this->context->smarty->assign(array( 'table' => $output, )); } $this->setTemplate('rsfavorites.tpl'); } }